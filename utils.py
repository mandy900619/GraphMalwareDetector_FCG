import argparse
import os

def parse_args():
    parser = argparse.ArgumentParser(description="Graph detector")
    parser.add_argument(
        "-i",
        "--input-path",
        type=str,
        metavar="PATH",
        help="input path of samples",
    )
    parser.add_argument(
        "-o",
        "--output-path",
        type=str,
        metavar="PATH",
        default="./detection_result.csv",
        help="output to the output file",
    )
    parser.add_argument(
        "-l",
        "--opcode-set",
        type=str,
        metavar="PATH",
        default="./opcode_set.pickle",
        help="path to the opcode set file",
    )
    return parser.parse_args()

def write_to_file(inputPath: str, outputPath: str, result: list):
    if '.csv' not in outputPath:
        outputPath = outputPath + '.csv'
    
    if not os.path.exists(outputPath):
        with open(outputPath, 'w') as f:
            line = 'Filename,Benign,Malware\n'
            f.write(line)
    
    with open(outputPath, 'a') as f:
        filename = os.path.basename(inputPath)
        line = filename + ',' + str(result[0]) + ',' + str(result[1]) + '\n'
        f.write(line)